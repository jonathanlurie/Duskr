![](https://www.dropbox.com/s/gzgwutqsvvhdfjg/logomini.png?dl=0&raw=1)

**_Duskr_** is a timelapse interpolator written in pure Python. It uses the `xmp` raw-development-files created by **Adobe CameraRaw** to create smooth transition from light to dark (or the oposite). It was made for MacOSX but could also work on Windows with few tricks (see at the end).

## Why *Duskr* was created
When you are capturing a timelapse with your camera, it takes a **lot** of pictures, most of the time some hundreds. You don't want to process all those pictures one by one. You don't want neither to batch process all of them with the very same settings, because the light was changing, the color became more and more warm, etc.  
If you are pretty well equipped, you might have some kind of *bulb-ramping device* like [Timelapse+](http://www.timelapseplus.com/), in other case, you might compensate the light-changing environment afterwards in your final video. With a **Jpeg color depth** (8 bits), and that's a shame when you capture all your timelapse in **raw** (12 or 14 bits).

**So, why _Duskr_ was created?** To batch-process your *raw* pictures in two clicks and adapt the development to the light-changing conditions.

## What you need
To use **Duskr**, you need **Adobe Photoshop** and some *raw* files.  
You also need [Python 2.7.X](https://www.python.org/downloads/) installed on you machine, which is usually the case by default.

## How it works
Step by step, you have to :

- Put your sequence of images in a folder. This folder must contain only images you want to make you timelapse with.
- Open the first *raw* image with **Photoshop**, it will open the **CameraRaw** module.
- Process your image the way you want, adjust the sliders to get a good looking picture.
- Click on the button `Finish` on the bottom-left corner of **CameraRaw**.
- Repeat the same thing with the very last image of your sequence.
- Once it is done, your folder will contain **2 additional files** generated by **CameraRaw**. They end by `xmp` and have the same name as your first and last image.
- Ready To Launch **Duskr**? Ok, double-click on the sunny icon : 
<center>![](https://www.dropbox.com/s/frojooo4mub864s/duskicon.png?dl=0&raw=1)</center>

- A command line window will pop, where you will *drag-and-drop* the first image of you sequence from the Finder:

<center>![](https://www.dropbox.com/s/gkm0rr47vt9viua/captureDuskr1.png?dl=0&raw=1)</center>

Then it displays the path of the image:

<center>![](https://www.dropbox.com/s/gzd4latyhfoleag/captureDuskr2.png?dl=0&raw=1)</center>

*Note :* here, I am using *raw* file from my Nikon camera, this is why they end by `.NEF`. See the section Compatibility for more info.

- Press enter to validate.

This will generate a `xmp` file for each image in your sequence folder. You don't need to bother about *how* and *why*, but if you are curious, you can still open them in a regular code editor.

- If you have **Photoshop** installed on your computer, it will be opened automatically at the end of the interpolation process. **CameraRaw** will show all your *raw* images on the left column:

<center>![](https://www.dropbox.com/s/lm6z3bym2fzm1o4/captureDuskr3.jpg?dl=0&raw=1)</center>

- You can check some images and see that the settings were interpolated.
- Then, it's time to **export** them! Click on the right-top button `Select All` :

<center>![](https://www.dropbox.com/s/9q8ccmfbgu1oqbu/captureDuskr4?dl=0&raw=1)</center>

- Finally, you click on the bottom-left button `Save the images` : 

<center>![](https://www.dropbox.com/s/cz13bcd4txuc5mr/captureDuskr5?dl=0&raw=1)</center>

Here stops the job of **Duskr**, you can use you favorite timelapse composer to make your final sequence! Personally, I use [Zeitraffer](https://itunes.apple.com/fr/app/zeitraffer/id572526628?mt=12), it's easy and efficient.

## Raw format compatibility
All along the development of **Duskr**, I used my Nikon camera and its `NEF` files. But as long as your *raw* files are compatible with **CameraRaw**, it is supposed to work.

## More info about xmp files
All the development settings are in the `.xmp` file attached to an original *raw* file. The purpose of the `.xmp` file is to provide a non-destructive way to edit an image, it only changes some parameters without modifying the original *raw* file.

The `.xmp` file uses an *XML* syntax, making it easily editable by a human or a program. The *XML* fields that handle the image development are stored as shown below in the `.xmp` file:

```xml
<x:xmpmeta>
	<rdf:RDF>
		<rdf:Description>
			<!-- Software informations -->
			xmlns:tiff="http://ns.adobe.com/tiff/1.0/"
			xmlns:exif="http://ns.adobe.com/exif/1.0/"
			...
			
			<!-- Camera manufacturer informations -->
			tiff:Make="NIKON CORPORATION"
			...
			
			<!-- EXIF informations -->
			exif:ExifVersion="0221"
			exif:ExposureTime="1/50"
			...
			
			<!-- Other infos and identifiers -->
			...
			

			<!-- Photo development settings -->
			crs:RawFileName="_NIK4337.NEF"
   			crs:Version="8.7.1"
   			crs:ProcessVersion="6.7"
   			crs:WhiteBalance="Custom"
   			crs:AutoWhiteVersion="134348800"
   			...
			
			<!-- Other development settings, less interesting -->
			...

		</rdf:Description>
	</rdf:RDF>
</x:xmpmeta>

```

The section commented *__Photo development settings__* are the one we are interested in. All the fields starting by `crs:` are related to an image development setting in Camera Raw. Here is the list of the most interesting:



| Setting   |      Field      |  Usual Value Range |
|----------|-------------|:------:|
| Temperature |  crs:Temperature | (2000; 50000) |
| Tint |  crs:Tint | (-150; +150) |
| Exposure correction |  crs:Exposure2012 | (-5; +5) |
| Contrast |  crs:Contrast2012 | (-100; +100) |
| High lights |  crs:Highlights2012 | (-100; +100) |
| Low Light (shadows) |  crs:Shadows2012 | (-100; +100) |
| Whites |  crs:Whites2012 | (-100; +100) |
| Blacks |  crs:Blacks2012 | (-100; +100) |
| Clarity |  crs:Clarity2012 | (-100; +100) |
| Vibrance |  crs:Vibrance | (-100; +100) |
| Saturation |  crs:Saturation | (-100; +100) |

**Duskr** will only make the interpolation over the above fields. The other fields will take the value set for the **first** raw image.

## Extend Duskr
So far, **Dusk** does not interpolate the other field than the one shown in the above section. The reason is that they usually need no interpolation. **But** if you want to add the interpolation over simple fields (understand : no *curves* settings), you can add the fields names in the `settings.ini` file.

So far, it is like that:

```
[rawDevSettings]
Temperature = crs:Temperature
Tint = crs:Tint
Exposure_correction = crs:Exposure2012
Contrast = crs:Contrast2012
High_lights = crs:Highlights2012
Low_Light = crs:Shadows2012
Whites = crs:Whites2012
Blacks = crs:Blacks2012
Clarity = crs:Clarity2012
Vibrance = crs:Vibrance
Saturation = crs:Saturation
```

The left side is the **name** of the setting : name it the way you want as long as it does not have spaces.  
The right side is the field you will find in the `xmp` file.


## Plateform compatibility
**Duskr** was Developed on MacOSX. Since it's pure Python, It should work pretty nice on Windows if you replace `Duskr.sh` by its `.bat` equivalent.   
One thing will for sure not work: the final auto-launch of **CameraRaw** with all the images. Anyway, you can select all of them, right-click, Open with **Photoshop**. 